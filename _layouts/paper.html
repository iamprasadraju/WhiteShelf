---
layout: default
---
<article class="paper-detail">
  {% if page.arxiv %}
  <p class="paper-code-top"><a href="https://arxiv.org/abs/{{ page.arxiv }}" target="_blank">arXiv:{{ page.arxiv }}</a></p>
  {% endif %}
  
  <h1 class="paper-title">{{ page.title }}</h1>
  
  <p class="paper-authors">
    {% if page.authors %}{{ page.authors | join: ", " }}{% endif %}
  </p>
  
  <div class="paper-meta">
    <span>{{ page.year }}</span>
    {% if page.category %}
    <span>{{ page.category | replace: '-', ' ' | capitalize }}</span>
    {% endif %}
    {% if page.arxiv %}
    <a href="https://arxiv.org/abs/{{ page.arxiv }}" target="_blank">arXiv</a>
    {% endif %}
    {% if page.pdf %}
    <a href="{{ page.pdf }}" target="_blank">PDF</a>
    {% elsif page.arxiv %}
    <a href="https://arxiv.org/pdf/{{ page.arxiv }}.pdf" target="_blank">PDF</a>
    {% endif %}
    {% if page.doi %}
    <a href="https://doi.org/{{ page.doi }}" target="_blank">DOI</a>
    {% endif %}
  </div>
  
  {% if page.tags %}
  <div class="paper-tags">
    {% for tag in page.tags %}
    <span class="paper-tag">{{ tag }}</span>
    {% endfor %}
  </div>
  {% endif %}
  
  {% if page.summary %}
  <div class="paper-summary">{{ page.summary | markdownify }}</div>
  {% endif %}
</article>

<hr>

<div class="paper-actions">
  <button class="btn-edit" data-filename="{{ page.name }}">Edit Tags & Category</button>
  <button class="btn-delete" data-filename="{{ page.name }}">Delete Paper</button>
</div>

<p><a href="{{ '/' | relative_url }}">&larr; Back to papers</a></p>

<div id="delete-modal" class="modal">
  <div class="modal-content">
    <h3>Delete Paper</h3>
    <p>Are you sure you want to delete this paper? This action cannot be undone.</p>
    <div class="modal-actions">
      <button id="confirm-delete" class="btn-delete">Delete</button>
      <button id="cancel-delete" class="btn-cancel">Cancel</button>
    </div>
  </div>
</div>

<div id="edit-modal" class="modal">
  <div class="modal-content">
    <h3>Edit Tags & Category</h3>
    <div class="form-group">
      <label>Category</label>
      <input type="text" id="edit-category" value="{{ page.category }}">
    </div>
    <div class="form-group">
      <label>Tags (comma separated)</label>
      <input type="text" id="edit-tags" value="{% if page.tags %}{{ page.tags | join: ', ' }}{% endif %}">
    </div>
    <div class="modal-actions">
      <button id="save-edit" class="btn-primary">Save</button>
      <button id="cancel-edit" class="btn-cancel">Cancel</button>
    </div>
  </div>
</div>

<div id="message-modal" class="modal">
  <div class="modal-content">
    <h3 id="message-title">Message</h3>
    <p id="message-text"></p>
    <div class="modal-actions">
      <button id="close-message" class="btn-primary">OK</button>
    </div>
  </div>
</div>

<script>
if (!window.location.hostname.includes('localhost') && !window.location.hostname.includes('127.0.0.1')) {
  document.querySelector('.btn-edit').style.display = 'none';
  document.querySelector('.btn-delete').style.display = 'none';
}

document.querySelector('.btn-edit').addEventListener('click', function() {
  document.getElementById('edit-modal').style.display = 'flex';
});

document.getElementById('cancel-edit').addEventListener('click', function() {
  document.getElementById('edit-modal').style.display = 'none';
});

function showMessage(title, text, isError = true) {
  document.getElementById('message-title').textContent = title;
  document.getElementById('message-text').textContent = text;
  document.getElementById('message-modal').style.display = 'flex';
}

document.getElementById('close-message').addEventListener('click', function() {
  document.getElementById('message-modal').style.display = 'none';
});

document.getElementById('save-edit').addEventListener('click', async function() {
  const filename = document.querySelector('.btn-edit').dataset.filename;
  const category = document.getElementById('edit-category').value.trim();
  const tags = document.getElementById('edit-tags').value;
  
  try {
    const response = await fetch('http://localhost:4567/update-paper', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ 
        filename: filename,
        category: category,
        tags: tags
      })
    });
    const data = await response.json();
    
    if (data.success) {
      document.getElementById('edit-modal').style.display = 'none';
      window.location.reload();
    } else {
      showMessage('Error', data.error);
    }
  } catch (error) {
    showMessage('Error', 'Error updating paper: ' + error.message);
  }
});

document.querySelector('.btn-delete').addEventListener('click', function() {
  document.getElementById('delete-modal').style.display = 'flex';
});

document.getElementById('cancel-delete').addEventListener('click', function() {
  document.getElementById('delete-modal').style.display = 'none';
});

document.getElementById('confirm-delete').addEventListener('click', async function() {
  const filename = document.querySelector('.btn-delete').dataset.filename;
  
  try {
    const response = await fetch('http://localhost:4567/delete-paper', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ filename: filename })
    });
    const data = await response.json();
    
    if (data.success) {
      document.getElementById('delete-modal').style.display = 'none';
      window.location.href = '{{ "/" | relative_url }}';
    } else {
      showMessage('Error', data.error);
    }
  } catch (error) {
    showMessage('Error', 'Error deleting paper: ' + error.message);
  }
});
</script>
